{
  "title": "Cleaning up locally installed Rubies &amp; Gems",
  "link": "http://caiustheory.com/cleaning-up-locally-installed-rubies--gems/",
  "published_at": "2017-11-12T11:30:24+0000",
  "guid": "http://caiustheory.com/cleaning-up-locally-installed-rubies--gems/",
  "uuid": "fcd0303e-2cf7-400b-9b3b-479950f4375d",
  "content": "&lt;p&gt;Given the following is broadly true:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Rubies installed to &lt;code&gt;~/.rubies&lt;/code&gt; (via ruby-install most likely)&lt;/li&gt;\n&lt;li&gt;Gems for each ruby version installed under ~/.gem (via chruby most likely)&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;What to do when you want to reclaim some disk space? Delete unused ruby versions of course! Pretty straight forward, look in ~/.rubies for ones you want to remove, then delete them.&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;$ ls ~/.rubies\nruby-2.0.0\nruby-2.1.7\nruby-2.3.1\nruby-2.4.1\n\n$ rm -r ~/.rubies/ruby-{2.0.0,2.1.7}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Then the problem is we&#39;re left with artifacts hanging around, namely any gems we installed for ruby 2.0.0 or 2.1.7 are still present under &lt;code&gt;~/.gem&lt;/code&gt; using up disk space. We could go through and find them by hand, or we could get the computer to delete anything under &lt;code&gt;~/.gem&lt;/code&gt; that doesn&#39;t have a corresponding runtime under &lt;code&gt;~/.rubies&lt;/code&gt;.&lt;/p&gt;\n&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span&gt;&lt;/span&gt;diff --old-line-format&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; --unchanged-line-format&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; --new-line-format&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HOME&lt;/span&gt;/.gem/ruby/%L &lt;span class=&#34;se&#34;&gt;&lt;/span&gt;\n  &amp;lt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ls ~/.rubies &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; sed -Ee &lt;span class=&#34;s1&#34;&gt;&amp;#39;s/ruby-|-p[0-9]+//g&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;lt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ls ~/.gem/ruby&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;&lt;/span&gt;\n  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; xargs -pL1 rm -r\n&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;\n\n&lt;p&gt;(&lt;code&gt;xargs -pL1&lt;/code&gt; will prompt with each command it wants to run before running it - answer &lt;code&gt;y&lt;/code&gt; to proceed, anything else to prevent it running that command. Lets you see what ruby versions it is removing before it does so.)&lt;/p&gt;\n\n&lt;pre&gt;&lt;code&gt;$ ls ~/.gem/ruby\n2.0.0\n2.1.7\n2.3.1\n2.4.1\n\n$ diff --old-line-format= --unchanged-line-format= --new-line-format=$HOME/.gem/ruby/%L \\n  &amp;lt;(ls ~/.rubies | sed -Ee &#39;s/ruby-|-p[0-9]+//g&#39;) &amp;lt;(ls ~/.gem/ruby) \\n  | xargs -pL1 rm -r\nrm -r /Users/caius/.gem/ruby/2.0.0?...y\nrm -r /Users/caius/.gem/ruby/2.1.7?...y\n\n$ ls ~/.gem/ruby\n2.3.1\n2.4.1\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;And now revel in your reclaimed disk space. (Hunting other large folders/items on your disk? &lt;a href=&#34;http://dev.yorhel.nl/ncdu&#34;&gt;&lt;code&gt;ncdu&lt;/code&gt;&lt;/a&gt; is a great tool for that.)&lt;/p&gt;\n"
}
